<?php/***** CyC Posts Large *****/class cyc_posts_large extends WP_Widget {    function __construct() {		parent::__construct(			'mh_cyc_posts_large', 'MH Bloque grande',			array(				'classname' => 'mh_newsdesk_lite_posts_large',				'description' => esc_html__('Display post with large image on front page for use in "Home 1" or "Home 4" widget areas.', 'mh-newsdesk-lite'),				'customize_selective_refresh' => true			)		);	}    function widget($args, $instance) {        extract($args);        $title = apply_filters('widget_title', empty($instance['title']) ? '' : $instance['title'], $instance, $this->id_base);        $category = isset($instance['category']) ? $instance['category'] : '';        $offset = empty($instance['offset']) ? '' : $instance['offset'];        $sticky = isset($instance['sticky']) ? $instance['sticky'] : 1;        $mostrar_copete = isset($instance['mostrar_copete']) ? $instance['mostrar_copete'] : 1;        $class = ( '' != $instance['class'] ) ? $instance['class'] : 'cyc_posts_large';        if ($category) {        	$cat_url = get_category_link($category);	        $before_title = $before_title . '<a href="' . esc_url($cat_url) . '" class="widget-title-link">';	        $after_title = '</a>' . $after_title;        }                if ( function_exists( 'z_get_zone_query' ) && z_get_zone( $category ) ) {            $posts_in_zone = z_get_posts_in_zone( $category, array( 'posts_per_page' => 1 )  );            if ( ! empty ( $posts_in_zone ) ) {                foreach( $posts_in_zone as $post ) {                     setup_postdata($post);                    $id_post = $post->ID;                    $excerpt = $post->post_excerpt;                }            }        } else {            $posts_in_cat = new WP_Query( array( 'category_name' => $category, 'posts_per_page' => 1, 'offset' => $offset ) );            if ( $posts_in_cat->have_posts() ) : while( $posts_in_cat->have_posts() ) : $posts_in_cat->the_post();                $id_post = get_the_ID();                $excerpt = get_the_excerpt();            endwhile; endif;        }        echo $before_widget;        if (!empty($title)) { echo $before_title . esc_attr($title) . $after_title; }		$args = array('posts_per_page' => '1', 'offset' => $offset, 'cat' => $category, 'ignore_sticky_posts' => $sticky);		//$widget_loop = new WP_Query($args); ?>		<div class="mh-fp-large-widget clearfix <?php echo $class ?>">                        <article <?php post_class('content-lead'); ?>>                                <div class="content-thumb content-lead-thumb">                                        <a href="<?php echo get_the_permalink( $id_post ); ?>" title="<?php echo get_the_title( $id_post ); ?>">                                            <?php if (has_post_thumbnail($id_post)) { echo get_the_post_thumbnail($id_post, array(361,202)); } else { echo '<img src="' . get_template_directory_uri() . '/images/placeholder-content-single.jpg' . '" alt="No Picture" />'; } ?>                                        <?php                                         $post_format = get_post_format( $id_post );                                        $featuredVideoURL = get_post_meta( $id_post, '_featuredVideoURL', true );                                        ?>                                        <?php if ( $post_format=='video' && $featuredVideoURL != '' ) : ?>                                        <span class="thumb-icon"><i class="fa fa-play"></i></span>                                        <?php elseif ( $post_format=='gallery' && $gallery = get_post_gallery_images( $id_post ) ) : ?>                                        <span class="thumb-icon"><i class="fa fa-camera"></i></span>                                        <?php endif; ?>                                        </a>                                </div>                                <?php //mh_newsdesk_lite_post_meta(); ?>                                <h3 class="content-lead-title"><a href="<?php echo get_the_permalink( $id_post ); ?>" title="<?php echo get_the_title( $id_post ); ?>" rel="bookmark"><?php echo get_the_title( $id_post ); ?></a></h3>                                <?php if ( '' != $mostrar_copete ) : ?>                                <div class="content-lead-excerpt">                                    <?php echo cyc_get_paragraph( $excerpt ) ?>                                </div>                                <?php endif; ?>                        </article>                        <hr class="mh-separator">                        <?php			//endwhile;			wp_reset_postdata(); ?>		</div><?php		echo $after_widget;    }    function update($new_instance, $old_instance) {        $instance = $old_instance;        $instance['title'] = sanitize_text_field($new_instance['title']);        $instance['category'] = sanitize_text_field($new_instance['category']);        //$instance['category'] = absint($new_instance['category']);        $instance['offset'] = absint($new_instance['offset']);        //$instance['sticky'] = isset($new_instance['sticky']) ? strip_tags($new_instance['sticky']) : '';        $instance['mostrar_copete'] = sanitize_text_field($new_instance['mostrar_copete']);        return $instance;    }    function form($instance) {        $defaults = array('title' => '', 'category' => '', 'offset' => '0', 'sticky' => 1);        $instance = wp_parse_args((array) $instance, $defaults); ?>        <p>        	<label for="<?php echo $this->get_field_id('title'); ?>">Título</label>                <input class="widefat" type="text" value="<?php echo esc_attr($instance['title']); ?>" name="<?php echo $this->get_field_name('title'); ?>" id="<?php echo $this->get_field_id('title'); ?>" />        </p>        <p>                <label for="<?php echo $this->get_field_id('category'); ?>">Elija una Categoría / Zona</label>                <input class="widefat" type="text" value="<?php echo esc_attr($instance['category']); ?>" name="<?php echo $this->get_field_name('category'); ?>" id="<?php echo $this->get_field_id('title'); ?>" />        </p>                <p>        	<label for="<?php echo $this->get_field_id('offset'); ?>">Saltear Posts (Offset)</label>			<input class="widefat" type="text" value="<?php echo esc_attr($instance['offset']); ?>" name="<?php echo $this->get_field_name('offset'); ?>" id="<?php echo $this->get_field_id('offset'); ?>" />        </p>                <p>            <input id="<?php echo $this->get_field_id('mostrar_copete'); ?>" name="<?php echo $this->get_field_name('mostrar_copete'); ?>" type="checkbox" value="1" <?php checked('1', $instance['mostrar_copete']); ?>/>            <label for="<?php echo $this->get_field_id('mostrar_copete'); ?>">Mostrar Copete</label>    	</p>            <?php    }}?>